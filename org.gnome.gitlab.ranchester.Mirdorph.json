{
	"app-id": "org.gnome.gitlab.ranchester.Mirdorph",
	"runtime": "org.gnome.Platform",
	"runtime-version": "40",
	"sdk": "org.gnome.Sdk",
	"command": "mirdorph",
	"finish-args": [
		"--share=network",
		"--share=ipc",
		"--socket=fallback-x11",
		"--socket=wayland",
		"--device=dri",
		"--filesystem=xdg-download",
		"--talk-name=org.freedesktop.secrets"
	],
	"cleanup": [
		"/include",
		"/lib/pkgconfig",
		"/man",
		"/share/doc",
		"/share/gtk-doc",
		"/share/man",
		"/share/pkgconfig",
		"*.la",
		"*.a"
	],
	"modules": [
		{
			"name": "python-setuptools-scm",
			"buildsystem": "simple",
			"build-commands": [
				"python3 setup.py build",
				"python3 setup.py egg_info",
				"python3 setup.py install --prefix=/app --root=/"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/pypa/setuptools_scm",
					"tag": "v4.1.2"
				}
			]
		},
		{
			"name": "python-discord-deps",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"aiohttp\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/9f/24/1444ee2c9aee531783c031072a273182109c6800320868ab87675d147a05/idna-3.1.tar.gz",
					"sha256": "c5b02147e01ea9920e6b0a3f1f7bb833612d507592c837a6c49552768f4054e1"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/97/e7/af7219a0fe240e8ef6bb555341a63c43045c21ab0392b4435e754b716fa1/yarl-1.6.3.tar.gz",
					"sha256": "8a9066529240171b68893d60dca86a763eae2139dd42f42106b03cf4b426bf10"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/99/f5/90ede947a3ce2d6de1614799f5fea4e93c19b6520a59dc5d2f64123b032f/aiohttp-3.7.4.post0.tar.gz",
					"sha256": "493d3299ebe5f5a7c66b9819eacdcfbbaaf1a8e84911ddffcdc48888497afecf"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/16/06/0f7367eafb692f73158e5c5cbca1aec798cdf78be5167f6415dd4205fa32/typing_extensions-3.7.4.3.tar.gz",
					"sha256": "99d4073b617d30288f569d3f13d2bd7548c3a7e4c8de87db09a9d29bb3a4a60c"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/1c/74/e8b46156f37ca56d10d895d4e8595aa2b344cff3c1fb3629ec97a8656ccb/multidict-5.1.0.tar.gz",
					"sha256": "25b4e5f22d3a37ddf3effc0710ba692cfc792c2b9edfb9c05aefe823256e84d5"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/f0/cb/80a4a274df7da7b8baf083249b0890a0579374c3d74b5ac0ee9291f912dc/attrs-20.3.0.tar.gz",
					"sha256": "832aa3cde19744e49938b91fea06d69ecb9e649c93ba974535d08ad92164f700"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/ee/2d/9cdc2b527e127b4c9db64b86647d567985940ac3698eeabc7ffaccb4ea61/chardet-4.0.0.tar.gz",
					"sha256": "0d6f53a15db4120f2b08c94f11e7d93d2c911ee118b6b30a04ec3ee8310179fa"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/a1/78/aae1545aba6e87e23ecab8d212b58bb70e72164b67eb090b81bb17ad38e3/async-timeout-3.0.1.tar.gz",
					"sha256": "0c3c816a028d47f659d6ff5c745cb2acf1f966da1fe5c19c77a70282b25f4c5f"
				}
			]
		},
		{
			"name": "python-discord",
			"buildsystem": "simple",
			"build-commands": [
				"python3 setup.py install --prefix=/app --root=/ --optimize=1"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/Rapptz/discord.py.git",
					"tag": "v1.7.2"
				},
				{
					"type": "patch",
					"path": "./patches/0001-fix-broken-.content-and-.embeds-and-more-in-self-bot.patch"
				}
			]
		},
		{
			"name": "python-flit-core",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"flit-core\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/be/ba/1f744cdc819428fc6b5084ec34d9b30660f6f9daaf70eead706e3203ec3c/toml-0.10.2.tar.gz",
					"sha256": "b3bda1d108d5dd99f4a20d24d9c348e91c4db7ab1b749200bded2f839ccbe68f"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/a7/06/700a2ae25c67bf3722c9b01788f43808ebc94b6a544b5008770e19406f6a/flit_core-3.2.0.tar.gz",
					"sha256": "ff87f25c5dbc24ef30ea334074e35030e4885e4c5de3bf4e21f15746f6d99431"
				}
			]
		},
		{
			"name": "python-flit",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"flit\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/76/72/19162eb5c1a34ad073f708d50dbd6b6f83bc4275c32dce348f135546daf9/flit-3.2.0.tar.gz",
					"sha256": "592464c9268bbacec9bc67b5a3ae62e6e090aeec1563e69501df338a1728e551"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/ea/b7/e0e3c1c467636186c39925827be42f16fee389dc404ac29e930e9136be70/idna-2.10.tar.gz",
					"sha256": "b307872f855b18632ce0c21c5e45be78c0ea7ae4c15c828c20788b26921eb3f6"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/06/a9/cd1fd8ee13f73a4d4f491ee219deeeae20afefa914dfb4c130cfc9dc397a/certifi-2020.12.5.tar.gz",
					"sha256": "1a4995114262bffbc2413b159f2a1a480c969de6e6eb13ee966d470af86af59c"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/4c/17/559b4d020f4b46e0287a2eddf2d8ebf76318fd3bd495f1625414b052fdc9/docutils-0.17.1.tar.gz",
					"sha256": "686577d2e4c32380bb50cbb22f575ed742d58168cee37e99117a854bcd88f125"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/cb/cf/871177f1fc795c6c10787bc0e1f27bb6cf7b81dbde399fd35860472cecbc/urllib3-1.26.4.tar.gz",
					"sha256": "e7b021f7241115872f92f43c6508082facffbd1c048e3c6e2bb9c2a157e28937"
				},
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/6b/47/c14abc08432ab22dc18b9892252efaf005ab44066de871e72a38d6af464b/requests-2.25.1.tar.gz",
					"sha256": "27973dd4a904a4f13b263a19c866c13b92a39ed1c964655f025f3f8d3d75b804"
				}
			]
		},
		{
			"name": "python-zipp",
			"buildsystem": "simple",
			"build-commands": [
				"python3 setup.py install --prefix=/app --root=/ --optimize=1"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/jaraco/zipp.git",
					"commit": "13fad1d6a6218f44dba59550c841cbd08f2364ae",
					"tag": "v3.4.1"
				}
			]
		},
		{
			"name": "python-importlib-metadata",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} git-importlib-metadata/ --no-build-isolation"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/python/importlib_metadata.git",
					"commit": "0c86a02fbbbbdc9a888d9f2a149ec0d2cf5e7d2c",
					"tag": "v4.0.1",
					"dest": "git-importlib-metadata"
				}
			]
		},
		{
			"name": "python-pycparser",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"pycparser\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/0f/86/e19659527668d70be91d0369aeaa055b4eb396b0f387a4f92293a20035bd/pycparser-2.20.tar.gz",
					"sha256": "2d475327684562c3a96cc71adf7dc8c4f0565175cf86b6d7a404ff4c771f15f0"
				}
			]
		},
		{
			"name": "python3-cffi",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"cffi\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/a8/20/025f59f929bbcaa579704f443a438135918484fffaacfaddba776b374563/cffi-1.14.5.tar.gz",
					"sha256": "fd78e5fee591709f32ef6edb9a015b4aa1a5022598e36227500c8f4e02328d9c"
				}
			]
		},
		{
			"name": "python-cryptography",
			"buildsystem": "simple",
			"build-options":{
				"build-args": [
					"--share=network"
				]
			},
			"build-commands": [
				"# ReE, resorting to pip instlall with network. First I can't install the latest version because outdated pip, and I tried upgrading it",
				"# but reee that. I tried so many things for seemingly hours and can't get it to work. And if I install older version then also weird",
				"# crypting install error. Fuck this",
				"pip3 install --prefix=/app --root=/ cryptography"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/pyca/cryptography.git",
					"tag": "3.4.7",
					"commit": "a19014a087759f3df72b2cd70ed7a0d8a6481340"
				}
			]
		},
		{
			"name": "python3-pyopenssl",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"pyopenssl\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/98/cd/cbc9c152daba9b5de6094a185c66f1c6eb91c507f378bb7cad83d623ea88/pyOpenSSL-20.0.1.tar.gz",
					"sha256": "4c231c759543ba02560fcd2480c48dcec4dae34c9da7d3747c508227e0624b51"
				}
			]
		},
		{
			"name": "python-jeepney",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"jeepney\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/bb/4f/06017fbbe94eeaf1e7852c2dd7a065ca7d813e17b4500f4e842531d72593/jeepney-0.6.0.tar.gz",
					"sha256": "7d59b6622675ca9e993a6bd38de845051d315f8b0c72cca3aef733a20b648657"
				}
			]
		},
		{
			"name": "python-secretstorage",
			"buildsystem": "simple",
			"build-commands": [
				"python3 setup.py install --prefix=/app --root=/ --optimize=1"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/mitya57/secretstorage.git",
					"commit": "ba2245d1d4227dac1d822cdcc6bd840891f416f0",
					"tag": "3.3.1"
				}
			]
		},
		{
			"name": "python-keyring",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} git-keyring/ --no-build-isolation"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/jaraco/keyring.git",
					"tag": "v23.0.1",
					"dest": "git-keyring"
				}
			]
		},
		{
			"name": "discordlogin",
			"buildsystem": "simple",
			"build-options": {
				"env": {
					"GOBIN": "/app/bin/"
				}
			},
			"build-commands": [
				"mkdir -p src/github.com/diamondburned/discordlogin; mv -vn ./* src/github.com/diamondburned/discordlogin; . /usr/lib/sdk/golang/enable.sh; export GOPATH=$PWD; go env -w GO111MODULE=off; go install github.com/diamondburned/discordlogin"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/diamondburned/discordlogin",
					"commit": "5772dfbb1dc132263b1ba396c478a93937710880"
				},
				{
					"type": "patch",
					"path": "./patches/0002-fix-webview-dependency.patch",
					"use-git": true
				},
				{
					"type": "git",
					"url": "https://github.com/webview/webview",
					"commit": "10ddbc570a0b",
					"dest": "src/github.com/webview/webview"
				}
			]
		},
		{
			"name": "mirdorph",
			"builddir": true,
			"buildsystem": "meson",
			"sources": [
				{
					"type": "dir",
					"path": "."
				}
			]
		}
	]
}
